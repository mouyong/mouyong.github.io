---
title: 五、扩展应用程序
date: 2019-12-20 15:10:04
categories: k8s
tags:
  - k8s
  - 运维
english_title: Extend-application
---

## 扩展部署

1. 查看部署
`kubectl get deployments`

2. 扩展部署
`kebuctl scale deployments/kubernetes-bootcamps --replicas=4`

3. 查看是否扩展成功
`kubectl get deployments`

4. 查看扩展的不同 ip 节点信息
`kubectl get pods -o wide`

5. 检查部署事件日志
`kubectl describe deployments/kubernetes-bootcamp`

第二步扩展将在部署日志中自动进行注册，可以查看部署的详细信息进行确认

## 负载均衡

1. 查看暴露的 IP 和端口
`kubectl describe services/kubernetes-bootcamp`

2. 创建一个环境变量 NODE_PORT 用于保存节点端口信息
`export NODE_PORT=$(kubectl get services/kubernetes-bootcamp -o go-template='{{(index .spec.ports 0).nodePort}}')`

3. 对暴露的 ip 和端口进行请求
`curl $(minikube ip):$NODE_PORT`

我们的每一个请求都会有不同的结果，这表明负载均衡正常工作

## 缩小部署

1. 缩小部署
`kubectl scale deployments/kubernetes-bootcamp --replicas=2`

2. 查看部署信息
`kubectl get deployments`

3. 查看 pods 信息
`kubectl get pods -o wide`
